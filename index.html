
<!DOCTYPE HTML>
<html>
<head>
    <title>GuoJing/DoubanAPICocoa-iOS Project</title>
  <meta charset="utf-8" />
<link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/feed.xml">
<link rel="icon" href="/images/icons/avatar.png">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="/style/css/bootstrap.css" type="text/css" media="screen">
<script type="text/javascript" src="/style/jquery-1.7.1.min.js"></script>
<link rel="stylesheet" href="/style/style.css" type="text/css">
<meta content="Douban api for cocoa, Very simple and easy to use. Support OS X Now." name="description"/>
<meta content="GuoJing/DoubanAPICocoa-iOS" name="keywords"/>
<script>
 $(document).ready(function(){
    $('.nav a').hover(
        function(){
            $(this).animate({opacity: 0.3}, 400)
        },
        function(){
            $(this).animate({opacity: 1}, 400)
        });
 });
 function getURLParameter(name) {
    return decodeURI(
        (RegExp(name + '=' + '(.+?)(&|$)').exec(location.search)||[,null])[1]
    );
 }
</script>
<style>
    .content img {
        width: auto;
    }
</style>
</head>

<body>

<div class="container">
<div class="banner">
 <ul class="nav nav-pills">
  <li><a href="/">Blog</a></li>
  <li><a href="https://github.com/GuoJing/DoubanAPICocoa-iOS">Github</a></li>
 </ul>
</div>

<div class="main clearfix">


<div class="posts">
    <div class="title">DoubanAPICocoa-iOS</div>
<div class="content">
    <h3>概要</h3>

<p>DoubanAPICocoa是一个Cocoa封装的豆瓣API库，非官方版，可以使用于iOS，并支持iOS6及之后的版本。<a href="https://github.com/GuoJing/DoubanAPICocoa-OSX">OS X 版本可参考这里</a>。</p>

<p>DoubanAPICocoa的底层支持并兼容老版本的<a href="https://github.com/lincode/douban-objc-client">douban-objc-client</a>，熟悉<a href="https://github.com/lincode/douban-objc-client">douban-objc-client</a>开发的同学也可以不用更新代码，直接移植到新的库里并且编译通过。但推荐使用DoubanAPICocoa提供的DOUEngine来实现代码。</p>

<p>注意：示例请自行替换apiKey，并且自行申请相关权限，如豆邮和线上活动以及更多高级的功能。</p>

<h3>目的</h3>

<ol>
<li>使开发更加容易，不用关注网络层的细节</li>
</ol>

<h3>特点</h3>

<ol>
<li>封装网络层</li>
<li>简单</li>
<li>使用闭包让开发者开发更简单</li>
<li>All consts</li>
<li>No Warning, No Error and No Build Analyze Errors</li>
</ol>

<h3>样例</h3>

<h4>验证</h4>

<p>声明一个engine：</p>

<pre><code>engine = [[DOUEngine alloc] initWithApiKey:kAPIKey withSecretKey:kPrivateKey withRedirUrl:kRedirectUrl];
</code></pre>

<p>打开豆瓣验证url：</p>

<pre><code>NSString *url_str = [self.engine getConnectUrl];
</code></pre>

<p>从豆瓣返回code并初始化engine：</p>

<pre><code>[self.engine didLoadWithCode:code];
</code></pre>

<p>验证通过。</p>

<h4>我是谁</h4>

<pre><code>[u getWhoAmI:successUserBlock failedBlock:failBlock];
</code></pre>

<h4>发广播</h4>

<pre><code>DOUBroadcastEngine *s = [self.engine getEngine:kDOUBroadcast];
[s say:self.shuo_field.title successBlock:successBlock failedBlock:failBlock];
</code></pre>

<h4>获取同城活动</h4>

<pre><code>DOUEventEngine *event_engine = [self.engine getEngine:kDOUEvent];
[event_engine getEventWithRemoteID:self.eid_field.title successBlock:successBlock failedBlock:failedBlock];
</code></pre>

<h3>变量</h3>

<p>该库封装了常用的变量，比如发日记如果是发私有的日记，可以直接使用kDOUPrivacyPrivate，同样相册的排序方式可以使用kDOUOrderDesc，无需自己写变量。</p>

<p>常用的变量文件在库的Engine/Utils里。</p>

<ol>
<li>DOUAPIConsts.h</li>
<li>DOUAPIConsts.h</li>
<li>DOUAPIErrorConsts.h</li>
</ol>

<h3>开发</h3>

<p>这个库支持最老的底层的实现方法，也可以非常容易的使用engine进行api开发，可以通过kDOU产品线获得相应的engine，每个engine都有getEngine方法。不过推荐在外面包装一个单例的共享engine，方便在代码各处使用。</p>

<p>可以删除任意不需要的模块并重新打包和分发，减少代码。</p>

<h3>示例</h3>

<p>大部分接口都有基本的示例，今后会提供更多更丰富的示例。</p>

<h3>其他</h3>

<p><strong><a href="http://developers.douban.com/">豆瓣API</a></strong></p>

<p><strong>并且该版本不支持GData等V1版本特性，只支持V2。</strong></p>

<p>如果你需要iOS版本，请去:</p>

<ol>
<li>开发版：<a href="https://github.com/lincode/douban-objc-client">douban-objc-client</a></li>
<li>官方版：<a href="https://github.com/douban/douban-objc-client">douban-objc-client</a></li>
</ol>

<h3>信息</h3>

<p>当前版本V0.1.3，主要职责为兼容iOS版本并且封装网络层，今后使用的方法可能会不同。</p>

<p>当前版本不支持GData等V1版本特性，只支持V2，所以必须使用https。</p>

<p>当前版本只适用于64位版本，考虑到今后32位的Mac也不多，所以暂时不打算支持。</p>

<h3>使用</h3>

<h3>Sample我还在做</h3>

<h3>发起一个异步请求</h3>

<pre><code>NSString *subPath = [NSString stringWithFormat:@&quot;/v2/event/%d&quot;, event_id];

DOUQuery *query = [[[DOUQuery alloc] initWithSubPath:subPath parameters:nil] autorelease];

query.apiBaseUrlString = service.apiBaseUrlString;

DOUHttpRequest *req = [DOUHttpRequest requestWithQuery:query target:self];

DOUService *service = [DOUService sharedInstance];
[service addRequest:req];
</code></pre>

<h3>历史</h3>

<p>v0.1</p>

<ol>
<li>发布一个移植版本。</li>
</ol>

<p><a href="https://bitdeli.com/free" title="Bitdeli Badge"><img src="https://d2weczhvl823v0.cloudfront.net/GuoJing/doubanapicocoa-ios/trend.png" alt="Bitdeli Badge"></a></p>

</div>

<div class="footer">

© Copryright by<a href="http://guojing.me/" target="_blank">GuoJing</a> 2012-2014 using <a href="http://www.github.com/" target="_blank">GitHub</a> and <a href="http://guojing.me/duidui" target="_blank">duidui</a>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42721249-1', 'guojing.me');
  ga('send', 'pageview');

</script>
</div>

</div>
</body>
</html>
